// ============================================================================
// Automatic Dark Mode Mixins
// ============================================================================
// These mixins generate utilities based on the configured strategy:
// - "media": Uses @media (prefers-color-scheme: dark) for system preference
// - "class": Uses .dark class on parent element for manual toggle
// ============================================================================

@use 'sass:map';
@use 'sass:color';
@use '../config/custom-config' as config;

// ============================================================================
// Primary Dark Mode Mixin
// ============================================================================
// Generates dark mode utilities based on $dark-mode-strategy config.
// Strategy "media": Outputs @media (prefers-color-scheme: dark) { ... }
// Strategy "class": Outputs .dark { ... }
// Usage (at TOP LEVEL of file):
//   @include dark-mode {
//     .dark\:text-primary { color: var(--color-primary); }
//   }
// ============================================================================

@mixin dark-mode {
  @if config.$dark-mode-strategy == 'media' {
    // Media query for system preference (automatic)
    @media (prefers-color-scheme: dark) {
      @content;
    }
  } @else if config.$dark-mode-strategy == 'class' {
    // Manual toggle via class on parent
    .dark {
      @content;
    }
  }
}

// Dark mode mixin for use WITHIN other selectors
// Usage:
//   .my-class {
//     color: black;
//     @include dark-mode-self {
//       color: white;
//     }
//   }
// Output (strategy "media"):
//   .my-class { color: black; }
//   @media (prefers-color-scheme: dark) {
//     .my-class { color: white; }
//   }
// Output (strategy "class"):
//   .my-class { color: black; }
//   .dark .my-class { color: white; }
@mixin dark-mode-self {
  @if config.$dark-mode-strategy == 'media' {
    @media (prefers-color-scheme: dark) {
      @content;
    }
  } @else if config.$dark-mode-strategy == 'class' {
    @at-root {
      .dark #{&} {
        @content;
      }
    }
  }
}

// Light mode mixin
// ============================================================================
// Usage (at TOP LEVEL):
//   @include light-mode {
//     .light\:text-primary { color: var(--color-primary); }
//   }
// ============================================================================
@mixin light-mode {
  @if config.$dark-mode-strategy == 'media' {
    @media (prefers-color-scheme: light) {
      @content;
    }
  } @else if config.$dark-mode-strategy == 'class' {
    // When using class strategy, light mode is the default
    // Only output content without wrapping (or could use :not(.dark))
    @content;
  }
}

// Light mode mixin for use WITHIN other selectors
// ============================================================================
@mixin light-mode-self {
  @if config.$dark-mode-strategy == 'media' {
    @media (prefers-color-scheme: light) {
      @content;
    }
  } @else if config.$dark-mode-strategy == 'class' {
    // Light mode is default when not inside .dark
    @at-root {
      :not(.dark) #{&} {
        @content;
      }
    }
  }
}

